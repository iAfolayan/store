"use strict";var cov_d89w4y7ww=function(){var path="/Users/andela/Desktop/sm/store-manager/app/controller/product.js",hash="4530715c1f160a2f873cd8bffce9b3674986730a",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/andela/Desktop/sm/store-manager/app/controller/product.js",statementMap:{"0":{start:{line:3,column:29},end:{line:3,column:84}},"1":{start:{line:5,column:0},end:{line:7,column:3}},"2":{start:{line:8,column:0},end:{line:8,column:25}},"3":{start:{line:10,column:23},end:{line:10,column:95}},"4":{start:{line:12,column:20},end:{line:12,column:89}},"5":{start:{line:14,column:16},end:{line:14,column:67}},"6":{start:{line:22,column:0},end:{line:192,column:3}},"7":{start:{line:24,column:4},end:{line:24,column:53}},"8":{start:{line:27,column:2},end:{line:190,column:6}},"9":{start:{line:37,column:6},end:{line:40,column:9}},"10":{start:{line:52,column:15},end:{line:52,column:28}},"11":{start:{line:54,column:20},end:{line:56,column:8}},"12":{start:{line:55,column:8},end:{line:55,column:43}},"13":{start:{line:58,column:6},end:{line:63,column:7}},"14":{start:{line:59,column:8},end:{line:62,column:11}},"15":{start:{line:65,column:6},end:{line:67,column:9}},"16":{start:{line:79,column:15},end:{line:79,column:28}},"17":{start:{line:80,column:17},end:{line:80,column:38}},"18":{start:{line:82,column:20},end:{line:84,column:8}},"19":{start:{line:83,column:8},end:{line:83,column:43}},"20":{start:{line:86,column:25},end:{line:88,column:8}},"21":{start:{line:87,column:8},end:{line:87,column:41}},"22":{start:{line:90,column:6},end:{line:99,column:7}},"23":{start:{line:91,column:8},end:{line:93,column:11}},"24":{start:{line:92,column:10},end:{line:92,column:39}},"25":{start:{line:94,column:8},end:{line:94,column:50}},"26":{start:{line:95,column:8},end:{line:98,column:11}},"27":{start:{line:101,column:6},end:{line:103,column:9}},"28":{start:{line:115,column:22},end:{line:115,column:30}},"29":{start:{line:116,column:17},end:{line:116,column:31}},"30":{start:{line:117,column:18},end:{line:117,column:33}},"31":{start:{line:118,column:24},end:{line:118,column:45}},"32":{start:{line:119,column:27},end:{line:119,column:51}},"33":{start:{line:120,column:18},end:{line:120,column:33}},"34":{start:{line:121,column:21},end:{line:121,column:39}},"35":{start:{line:122,column:15},end:{line:122,column:43}},"36":{start:{line:124,column:6},end:{line:126,column:7}},"37":{start:{line:125,column:24},end:{line:125,column:41}},"38":{start:{line:128,column:21},end:{line:128,column:34}},"39":{start:{line:130,column:6},end:{line:130,column:65}},"40":{start:{line:131,column:6},end:{line:131,column:73}},"41":{start:{line:132,column:6},end:{line:132,column:67}},"42":{start:{line:133,column:6},end:{line:133,column:79}},"43":{start:{line:134,column:6},end:{line:134,column:73}},"44":{start:{line:135,column:6},end:{line:135,column:78}},"45":{start:{line:137,column:19},end:{line:137,column:41}},"46":{start:{line:139,column:6},end:{line:160,column:7}},"47":{start:{line:140,column:8},end:{line:142,column:11}},"48":{start:{line:144,column:25},end:{line:152,column:9}},"49":{start:{line:154,column:8},end:{line:154,column:43}},"50":{start:{line:156,column:8},end:{line:159,column:11}},"51":{start:{line:172,column:15},end:{line:172,column:28}},"52":{start:{line:174,column:25},end:{line:176,column:8}},"53":{start:{line:175,column:8},end:{line:175,column:43}},"54":{start:{line:178,column:6},end:{line:188,column:7}},"55":{start:{line:179,column:8},end:{line:179,column:50}},"56":{start:{line:181,column:8},end:{line:183,column:11}},"57":{start:{line:185,column:8},end:{line:187,column:11}},"58":{start:{line:191,column:2},end:{line:191,column:21}},"59":{start:{line:194,column:15},end:{line:194,column:26}},"60":{start:{line:195,column:0},end:{line:195,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:22,column:0},end:{line:22,column:1}},loc:{start:{line:22,column:12},end:{line:192,column:1}},line:22},"1":{name:"ProductCtrl",decl:{start:{line:23,column:11},end:{line:23,column:22}},loc:{start:{line:23,column:25},end:{line:25,column:3}},line:23},"2":{name:"getAll",decl:{start:{line:36,column:20},end:{line:36,column:26}},loc:{start:{line:36,column:37},end:{line:41,column:5}},line:36},"3":{name:"getOne",decl:{start:{line:51,column:20},end:{line:51,column:26}},loc:{start:{line:51,column:37},end:{line:68,column:5}},line:51},"4":{name:"(anonymous_4)",decl:{start:{line:54,column:43},end:{line:54,column:44}},loc:{start:{line:54,column:58},end:{line:56,column:7}},line:54},"5":{name:"updateOne",decl:{start:{line:78,column:20},end:{line:78,column:29}},loc:{start:{line:78,column:40},end:{line:104,column:5}},line:78},"6":{name:"(anonymous_6)",decl:{start:{line:82,column:43},end:{line:82,column:44}},loc:{start:{line:82,column:58},end:{line:84,column:7}},line:82},"7":{name:"(anonymous_7)",decl:{start:{line:86,column:53},end:{line:86,column:54}},loc:{start:{line:86,column:66},end:{line:88,column:7}},line:86},"8":{name:"(anonymous_8)",decl:{start:{line:91,column:21},end:{line:91,column:22}},loc:{start:{line:91,column:36},end:{line:93,column:9}},line:91},"9":{name:"addProduct",decl:{start:{line:114,column:20},end:{line:114,column:30}},loc:{start:{line:114,column:41},end:{line:161,column:5}},line:114},"10":{name:"deleteProduct",decl:{start:{line:171,column:20},end:{line:171,column:33}},loc:{start:{line:171,column:44},end:{line:189,column:5}},line:171},"11":{name:"(anonymous_11)",decl:{start:{line:174,column:53},end:{line:174,column:54}},loc:{start:{line:174,column:68},end:{line:176,column:7}},line:174}},branchMap:{"0":{loc:{start:{line:58,column:6},end:{line:63,column:7}},type:"if",locations:[{start:{line:58,column:6},end:{line:63,column:7}},{start:{line:58,column:6},end:{line:63,column:7}}],line:58},"1":{loc:{start:{line:90,column:6},end:{line:99,column:7}},type:"if",locations:[{start:{line:90,column:6},end:{line:99,column:7}},{start:{line:90,column:6},end:{line:99,column:7}}],line:90},"2":{loc:{start:{line:124,column:6},end:{line:126,column:7}},type:"if",locations:[{start:{line:124,column:6},end:{line:126,column:7}},{start:{line:124,column:6},end:{line:126,column:7}}],line:124},"3":{loc:{start:{line:139,column:6},end:{line:160,column:7}},type:"if",locations:[{start:{line:139,column:6},end:{line:160,column:7}},{start:{line:139,column:6},end:{line:160,column:7}}],line:139},"4":{loc:{start:{line:178,column:6},end:{line:188,column:7}},type:"if",locations:[{start:{line:178,column:6},end:{line:188,column:7}},{start:{line:178,column:6},end:{line:188,column:7}}],line:178}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var _interopRequireDefault=(cov_d89w4y7ww.s[0]++,require("@babel/runtime/helpers/interopRequireDefault"));cov_d89w4y7ww.s[1]++;Object.defineProperty(exports,"__esModule",{value:true});cov_d89w4y7ww.s[2]++;exports.default=void 0;var _classCallCheck2=(cov_d89w4y7ww.s[3]++,_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")));var _createClass2=(cov_d89w4y7ww.s[4]++,_interopRequireDefault(require("@babel/runtime/helpers/createClass")));var _products=(cov_d89w4y7ww.s[5]++,_interopRequireDefault(require("../data/products")));/**
 * @class ProductCtrl
 * @classdesc manages products
 */var ProductCtrl=(/*#__PURE__*/cov_d89w4y7ww.s[6]++,function(){cov_d89w4y7ww.f[0]++;function ProductCtrl(){cov_d89w4y7ww.f[1]++;cov_d89w4y7ww.s[7]++;(0,_classCallCheck2.default)(this,ProductCtrl);}cov_d89w4y7ww.s[8]++;(0,_createClass2.default)(ProductCtrl,null,[{key:"getAll",/**
     * @description retrieves all products
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {products} - all available products
     */value:function getAll(req,res){cov_d89w4y7ww.f[2]++;cov_d89w4y7ww.s[9]++;res.status(200).json({msg:'products successfully retrieved',data:_products.default});}/**
     * @description retrieve a single product
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {product} - Product detail
     */},{key:"getOne",value:function getOne(req,res){cov_d89w4y7ww.f[3]++;var id=(cov_d89w4y7ww.s[10]++,req.params.id);var product=(cov_d89w4y7ww.s[11]++,_products.default.find(function(prd){cov_d89w4y7ww.f[4]++;cov_d89w4y7ww.s[12]++;return prd.id===parseInt(id,10);}));cov_d89w4y7ww.s[13]++;if(product){cov_d89w4y7ww.b[0][0]++;cov_d89w4y7ww.s[14]++;return res.status(200).send({msg:'product successfully found',data:product});}else{cov_d89w4y7ww.b[0][1]++;}cov_d89w4y7ww.s[15]++;res.status(404).send({msg:'product not found'});}/**
     * @description - Update a product
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {null} - no returns
     */},{key:"updateOne",value:function updateOne(req,res){cov_d89w4y7ww.f[5]++;var id=(cov_d89w4y7ww.s[16]++,req.params.id);var keys=(cov_d89w4y7ww.s[17]++,Object.keys(req.body));var product=(cov_d89w4y7ww.s[18]++,_products.default.find(function(prd){cov_d89w4y7ww.f[6]++;cov_d89w4y7ww.s[19]++;return prd.id===parseInt(id,10);}));var productIndex=(cov_d89w4y7ww.s[20]++,_products.default.findIndex(function(p){cov_d89w4y7ww.f[7]++;cov_d89w4y7ww.s[21]++;return p.id===parseInt(id,10);}));cov_d89w4y7ww.s[22]++;if(product){cov_d89w4y7ww.b[1][0]++;cov_d89w4y7ww.s[23]++;keys.forEach(function(key){cov_d89w4y7ww.f[8]++;cov_d89w4y7ww.s[24]++;product[key]=req.body[key];});cov_d89w4y7ww.s[25]++;_products.default[productIndex]=product;cov_d89w4y7ww.s[26]++;return res.status(200).send({msg:'Product successfully updated',data:product});}else{cov_d89w4y7ww.b[1][1]++;}cov_d89w4y7ww.s[27]++;res.status(404).json({msg:'Product not found'});}/**
     * @description - Create a new product
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {product} - Product
     */},{key:"addProduct",value:function addProduct(req,res){cov_d89w4y7ww.f[9]++;var _req$body=(cov_d89w4y7ww.s[28]++,req.body),name=(cov_d89w4y7ww.s[29]++,_req$body.name),price=(cov_d89w4y7ww.s[30]++,_req$body.price),description=(cov_d89w4y7ww.s[31]++,_req$body.description),minimumAllowed=(cov_d89w4y7ww.s[32]++,_req$body.minimumAllowed),image=(cov_d89w4y7ww.s[33]++,_req$body.image),category=(cov_d89w4y7ww.s[34]++,_req$body.category);var id=(cov_d89w4y7ww.s[35]++,_products.default.length+1);// Handle Image
cov_d89w4y7ww.s[36]++;if(req.file){cov_d89w4y7ww.b[2][0]++;var _prdImage=(cov_d89w4y7ww.s[37]++,req.file.filename);}else{cov_d89w4y7ww.b[2][1]++;}var prdImage=(cov_d89w4y7ww.s[38]++,'noImage.jpg');// Validate form
cov_d89w4y7ww.s[39]++;req.checkBody('name','Name field is required').notEmpty();cov_d89w4y7ww.s[40]++;req.checkBody('category','Category field is required').notEmpty();cov_d89w4y7ww.s[41]++;req.checkBody('price','Price field is required').notEmpty();cov_d89w4y7ww.s[42]++;req.checkBody('description','Description field is required').notEmpty();cov_d89w4y7ww.s[43]++;req.checkBody('quantity','Quantity field is required').notEmpty();cov_d89w4y7ww.s[44]++;req.checkBody('minimumAllowed','Minimum field is required').notEmpty();// Check errors
var errors=(cov_d89w4y7ww.s[45]++,req.validationErrors());cov_d89w4y7ww.s[46]++;if(errors){cov_d89w4y7ww.b[3][0]++;cov_d89w4y7ww.s[47]++;res.status(400).json({errors:errors});}else{cov_d89w4y7ww.b[3][1]++;var newProduct=(cov_d89w4y7ww.s[48]++,{id:id,name:name,price:price,description:description,minimumAllowed:minimumAllowed,image:image,category:category});cov_d89w4y7ww.s[49]++;_products.default.push(newProduct);cov_d89w4y7ww.s[50]++;res.status(201).json({msg:'A new product was successfully created',data:newProduct});}}/**
     * @description - Delete an existing product
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {nulll} - no returns
     */},{key:"deleteProduct",value:function deleteProduct(req,res){cov_d89w4y7ww.f[10]++;var id=(cov_d89w4y7ww.s[51]++,req.params.id);var productIndex=(cov_d89w4y7ww.s[52]++,_products.default.findIndex(function(prd){cov_d89w4y7ww.f[11]++;cov_d89w4y7ww.s[53]++;return prd.id===parseInt(id,10);}));cov_d89w4y7ww.s[54]++;if(productIndex>-1){cov_d89w4y7ww.b[4][0]++;cov_d89w4y7ww.s[55]++;_products.default.splice(productIndex,1);cov_d89w4y7ww.s[56]++;res.status(200).json({msg:'Product Deleted'});}else{cov_d89w4y7ww.b[4][1]++;cov_d89w4y7ww.s[57]++;res.status(404).send({msg:'Product not found'});}}}]);cov_d89w4y7ww.s[58]++;return ProductCtrl;}());var _default=(cov_d89w4y7ww.s[59]++,ProductCtrl);cov_d89w4y7ww.s[60]++;exports.default=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb2R1Y3QuanMiXSwibmFtZXMiOlsiUHJvZHVjdEN0cmwiLCJyZXEiLCJyZXMiLCJzdGF0dXMiLCJqc29uIiwibXNnIiwiZGF0YSIsImF2YWlsYWJsZVByb2R1Y3RzIiwiaWQiLCJwYXJhbXMiLCJwcm9kdWN0IiwiZmluZCIsInByZCIsInBhcnNlSW50Iiwic2VuZCIsImtleXMiLCJPYmplY3QiLCJib2R5IiwicHJvZHVjdEluZGV4IiwiZmluZEluZGV4IiwicCIsImZvckVhY2giLCJrZXkiLCJuYW1lIiwicHJpY2UiLCJkZXNjcmlwdGlvbiIsIm1pbmltdW1BbGxvd2VkIiwiaW1hZ2UiLCJjYXRlZ29yeSIsImxlbmd0aCIsImZpbGUiLCJwcmRJbWFnZSIsImZpbGVuYW1lIiwiY2hlY2tCb2R5Iiwibm90RW1wdHkiLCJlcnJvcnMiLCJ2YWxpZGF0aW9uRXJyb3JzIiwibmV3UHJvZHVjdCIsInB1c2giLCJzcGxpY2UiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFFQTs7OztJQUlNQSxXOzs7Ozs7Ozs7O0FBQ0o7Ozs7OzsyQkFNY0MsRyxFQUFLQyxHLEVBQUs7QUFDdEJBLE1BQUFBLEdBQUcsQ0FBQ0MsTUFBSixDQUFXLEdBQVgsRUFDR0MsSUFESCxDQUNRO0FBQ0pDLFFBQUFBLEdBQUcsRUFBRSxpQ0FERDtBQUVKQyxRQUFBQSxJQUFJLEVBQUVDO0FBRkYsT0FEUjtBQUtEO0FBRUQ7Ozs7Ozs7OzsyQkFNY04sRyxFQUFLQyxHLEVBQUs7QUFBQSxVQUNkTSxFQURjLEdBQ1BQLEdBQUcsQ0FBQ1EsTUFERyxDQUNkRCxFQURjOztBQUV0QixVQUFNRSxPQUFPLEdBQUdILGtCQUFrQkksSUFBbEIsQ0FBdUIsVUFBQUMsR0FBRztBQUFBLGVBQUlBLEdBQUcsQ0FBQ0osRUFBSixLQUFXSyxRQUFRLENBQUNMLEVBQUQsRUFBSyxFQUFMLENBQXZCO0FBQUEsT0FBMUIsQ0FBaEI7O0FBQ0EsVUFBSUUsT0FBSixFQUFhO0FBQ1gsZUFBT1IsR0FBRyxD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LE9BQS9CLENBQXJCOztBQUNBLFVBQUlVLFlBQVksR0FBRyxDQUFDLENBQXBCLEVBQXVCO0FBQ3JCWCwwQkFBa0JnQyxNQUFsQixDQUF5QnJCLFlBQXpCLEVBQXVDLENBQXZDOztBQUNBaEIsUUFBQUEsR0FBRyxDQUFDQyxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUI7QUFDbkJDLFVBQUFBLEdBQUcsRUFBRTtBQURjLFNBQXJCO0FBR0QsT0FMRCxNQUtPO0FBQ0xILFFBQUFBLEdBQUcsQ0FBQ0MsTUFBSixDQUFXLEdBQVgsRUFBZ0JXLElBQWhCLENBQXFCO0FBQ25CVCxVQUFBQSxHQUFHLEVBQUU7QUFEYyxTQUFyQjtBQUdEO0FBQ0Y7Ozs7O2VBR1lMLFciLCJzb3VyY2VSb290IjoiL1VzZXJzL2FuZGVsYS9EZXNrdG9wL3NtL3N0b3JlLW1hbmFnZXIvYXBwL2NvbnRyb2xsZXIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXZhaWxhYmxlUHJvZHVjdHMgZnJvbSAnLi4vZGF0YS9wcm9kdWN0cyc7XG5cbi8qKlxuICogQGNsYXNzIFByb2R1Y3RDdHJsXG4gKiBAY2xhc3NkZXNjIG1hbmFnZXMgcHJvZHVjdHNcbiAqL1xuY2xhc3MgUHJvZHVjdEN0cmwge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIHJldHJpZXZlcyBhbGwgcHJvZHVjdHNcbiAgICogQHBhcmFtIHsqfSByZXEgLSByZXF1ZXN0IG9iamVjdFxuICAgKiBAcGFyYW0geyp9IHJlcyAtIHJlc3BvbnNlIG9iamVjdFxuICAgKiBAcmV0dXJucyB7cHJvZHVjdHN9IC0gYWxsIGF2YWlsYWJsZSBwcm9kdWN0c1xuICAgKi9cbiAgc3RhdGljIGdldEFsbChyZXEsIHJlcykge1xuICAgIHJlcy5zdGF0dXMoMjAwKVxuICAgICAgLmpzb24oe1xuICAgICAgICBtc2c6ICdwcm9kdWN0cyBzdWNjZXNzZnVsbHkgcmV0cmlldmVkJyxcbiAgICAgICAgZGF0YTogYXZhaWxhYmxlUHJvZHVjdHNcbiAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiByZXRyaWV2ZSBhIHNpbmdsZSBwcm9kdWN0XG4gICAqIEBwYXJhbSB7Kn0gcmVxIC0gcmVxdWVzdCBvYmplY3RcbiAgICogQHBhcmFtIHsqfSByZXMgLSByZXNwb25zZSBvYmplY3RcbiAgICogQHJldHVybnMge3Byb2R1Y3R9IC0gUHJvZHVjdCBkZXRhaWxcbiAgICovXG4gIHN0YXRpYyBnZXRPbmUocmVxLCByZXMpIHtcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHByb2R1Y3QgPSBhdmFpbGFibGVQcm9kdWN0cy5maW5kKHByZCA9PiBwcmQuaWQgPT09IHBhcnNlSW50KGlkLCAxMCkpO1xuICAgIGlmIChwcm9kdWN0KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoe1xuICAgICAgICBtc2c6ICdwcm9kdWN0IHN1Y2Nlc3NmdWxseSBmb3VuZCcsXG4gICAgICAgIGRhdGE6IHByb2R1Y3RcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXMuc3RhdHVzKDQwNCkuc2VuZCh7IG1zZzogJ3Byb2R1Y3Qgbm90IGZvdW5kJyB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb24gLSBVcGRhdGUgYSBwcm9kdWN0XG4gICAqIEBwYXJhbSB7Kn0gcmVxIC0gcmVxdWVzdCBvYmplY3RcbiAgICogQHBhcmFtIHsqfSByZXMgLSByZXNwb25zZSBvYmplY3RcbiAgICogQHJldHVybnMge251bGx9IC0gbm8gcmV0dXJuc1xuICAgKi9cbiAgc3RhdGljIHVwZGF0ZU9uZShyZXEsIHJlcykge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHJlcS5ib2R5KTtcbiAgICBjb25zdCBwcm9kdWN0ID0gYXZhaWxhYmxlUHJvZHVjdHMuZmluZChwcmQgPT4gcHJkLmlkID09PSBwYXJzZUludChpZCwgMTApKTtcbiAgICBjb25zdCBwcm9kdWN0SW5kZXggPSBhdmFpbGFibGVQcm9kdWN0cy5maW5kSW5kZXgocCA9PiBwLmlkID09PSBwYXJzZUludChpZCwgMTApKTtcbiAgICBpZiAocHJvZHVjdCkge1xuICAgICAga2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgcHJvZHVjdFtrZXldID0gcmVxLmJvZHlba2V5XTtcbiAgICAgIH0pO1xuICAgICAgYXZhaWxhYmxlUHJvZHVjdHNbcHJvZHVjdEluZGV4XSA9IHByb2R1Y3Q7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLnNlbmQoe1xuICAgICAgICBtc2c6ICdQcm9kdWN0IHN1Y2Nlc3NmdWxseSB1cGRhdGVkJyxcbiAgICAgICAgZGF0YTogcHJvZHVjdCxcbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICBtc2c6ICdQcm9kdWN0IG5vdCBmb3VuZCcsXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIC0gQ3JlYXRlIGEgbmV3IHByb2R1Y3RcbiAgICogQHBhcmFtIHsqfSByZXEgLSByZXF1ZXN0IG9iamVjdFxuICAgKiBAcGFyYW0geyp9IHJlcyAtIHJlc3BvbnNlIG9iamVjdFxuICAgKiBAcmV0dXJucyB7cHJvZHVjdH0gLSBQcm9kdWN0XG4gICAqL1xuICBzdGF0aWMgYWRkUHJvZHVjdChyZXEsIHJlcykge1xuICAgIGNvbnN0IHtcbiAgICAgIG5hbWUsIHByaWNlLCBkZXNjcmlwdGlvbiwgbWluaW11bUFsbG93ZWQsIGltYWdlLCBjYXRlZ29yeVxuICAgIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCBpZCA9IGF2YWlsYWJsZVByb2R1Y3RzLmxlbmd0aCArIDE7XG4gICAgLy8gSGFuZGxlIEltYWdlXG4gICAgaWYgKHJlcS5maWxlKSB7XG4gICAgICBjb25zdCBwcmRJbWFnZSA9IHJlcS5maWxlLmZpbGVuYW1lO1xuICAgIH1cbiAgICBjb25zdCBwcmRJbWFnZSA9ICdub0ltYWdlLmpwZyc7XG5cbiAgICAvLyBWYWxpZGF0ZSBmb3JtXG4gICAgcmVxLmNoZWNrQm9keSgnbmFtZScsICdOYW1lIGZpZWxkIGlzIHJlcXVpcmVkJykubm90RW1wdHkoKTtcbiAgICByZXEuY2hlY2tCb2R5KCdjYXRlZ29yeScsICdDYXRlZ29yeSBmaWVsZCBpcyByZXF1aXJlZCcpLm5vdEVtcHR5KCk7XG4gICAgcmVxLmNoZWNrQm9keSgncHJpY2UnLCAnUHJpY2UgZmllbGQgaXMgcmVxdWlyZWQnKS5ub3RFbXB0eSgpO1xuICAgIHJlcS5jaGVja0JvZHkoJ2Rlc2NyaXB0aW9uJywgJ0Rlc2NyaXB0aW9uIGZpZWxkIGlzIHJlcXVpcmVkJykubm90RW1wdHkoKTtcbiAgICByZXEuY2hlY2tCb2R5KCdxdWFudGl0eScsICdRdWFudGl0eSBmaWVsZCBpcyByZXF1aXJlZCcpLm5vdEVtcHR5KCk7XG4gICAgcmVxLmNoZWNrQm9keSgnbWluaW11bUFsbG93ZWQnLCAnTWluaW11bSBmaWVsZCBpcyByZXF1aXJlZCcpLm5vdEVtcHR5KCk7XG5cbiAgICAvLyBDaGVjayBlcnJvcnNcbiAgICBjb25zdCBlcnJvcnMgPSByZXEudmFsaWRhdGlvbkVycm9ycygpO1xuICAgIGlmIChlcnJvcnMpIHtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3JzIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBuZXdQcm9kdWN0ID0ge1xuICAgICAgICBpZCwgbmFtZSwgcHJpY2UsIGRlc2NyaXB0aW9uLCBtaW5pbXVtQWxsb3dlZCwgaW1hZ2UsIGNhdGVnb3J5XG4gICAgICB9O1xuICAgICAgYXZhaWxhYmxlUHJvZHVjdHMucHVzaChuZXdQcm9kdWN0KTtcbiAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHtcbiAgICAgICAgbXNnOiAnQSBuZXcgcHJvZHVjdCB3YXMgc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQnLFxuICAgICAgICBkYXRhOiBuZXdQcm9kdWN0XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIC0gRGVsZXRlIGFuIGV4aXN0aW5nIHByb2R1Y3RcbiAgICogQHBhcmFtIHsqfSByZXEgLSByZXF1ZXN0IG9iamVjdFxuICAgKiBAcGFyYW0geyp9IHJlcyAtIHJlc3BvbnNlIG9iamVjdFxuICAgKiBAcmV0dXJucyB7bnVsbGx9IC0gbm8gcmV0dXJuc1xuICAgKi9cbiAgc3RhdGljIGRlbGV0ZVByb2R1Y3QocmVxLCByZXMpIHtcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHByb2R1Y3RJbmRleCA9IGF2YWlsYWJsZVByb2R1Y3RzLmZpbmRJbmRleChwcmQgPT4gcHJkLmlkID09PSBwYXJzZUludChpZCwgMTApKTtcbiAgICBpZiAocHJvZHVjdEluZGV4ID4gLTEpIHtcbiAgICAgIGF2YWlsYWJsZVByb2R1Y3RzLnNwbGljZShwcm9kdWN0SW5kZXgsIDEpO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBtc2c6ICdQcm9kdWN0IERlbGV0ZWQnXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzLnN0YXR1cyg0MDQpLnNlbmQoe1xuICAgICAgICBtc2c6ICdQcm9kdWN0IG5vdCBmb3VuZCdcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQcm9kdWN0Q3RybDtcbiJdfQ==