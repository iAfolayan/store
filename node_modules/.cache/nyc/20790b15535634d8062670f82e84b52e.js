"use strict";var cov_10540wvn02=function(){var path="/Users/andela/Desktop/sm/store-manager/app/controller/user.js",hash="0531247ae394973a0b099379cc2a6000731c2b7e",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/Users/andela/Desktop/sm/store-manager/app/controller/user.js",statementMap:{"0":{start:{line:3,column:29},end:{line:3,column:84}},"1":{start:{line:5,column:0},end:{line:7,column:3}},"2":{start:{line:8,column:0},end:{line:8,column:25}},"3":{start:{line:10,column:23},end:{line:10,column:95}},"4":{start:{line:12,column:20},end:{line:12,column:89}},"5":{start:{line:14,column:20},end:{line:14,column:67}},"6":{start:{line:16,column:13},end:{line:16,column:61}},"7":{start:{line:24,column:0},end:{line:152,column:3}},"8":{start:{line:26,column:4},end:{line:26,column:51}},"9":{start:{line:29,column:2},end:{line:150,column:6}},"10":{start:{line:39,column:6},end:{line:41,column:9}},"11":{start:{line:53,column:22},end:{line:53,column:30}},"12":{start:{line:54,column:18},end:{line:54,column:33}},"13":{start:{line:55,column:22},end:{line:55,column:41}},"14":{start:{line:56,column:21},end:{line:56,column:39}},"15":{start:{line:57,column:25},end:{line:57,column:47}},"16":{start:{line:58,column:24},end:{line:58,column:45}},"17":{start:{line:59,column:17},end:{line:59,column:31}},"18":{start:{line:60,column:19},end:{line:60,column:35}},"19":{start:{line:61,column:21},end:{line:61,column:39}},"20":{start:{line:62,column:27},end:{line:62,column:51}},"21":{start:{line:63,column:15},end:{line:63,column:40}},"22":{start:{line:64,column:20},end:{line:64,column:36}},"23":{start:{line:65,column:22},end:{line:65,column:32}},"24":{start:{line:66,column:20},end:{line:79,column:7}},"25":{start:{line:81,column:6},end:{line:81,column:35}},"26":{start:{line:83,column:6},end:{line:86,column:9}},"27":{start:{line:98,column:23},end:{line:98,column:31}},"28":{start:{line:99,column:20},end:{line:99,column:38}},"29":{start:{line:100,column:21},end:{line:100,column:40}},"30":{start:{line:102,column:23},end:{line:104,column:8}},"31":{start:{line:103,column:8},end:{line:103,column:70}},"32":{start:{line:106,column:6},end:{line:117,column:7}},"33":{start:{line:107,column:20},end:{line:111,column:10}},"34":{start:{line:113,column:8},end:{line:116,column:11}},"35":{start:{line:119,column:6},end:{line:121,column:9}},"36":{start:{line:133,column:25},end:{line:133,column:46}},"37":{start:{line:135,column:22},end:{line:137,column:8}},"38":{start:{line:136,column:8},end:{line:136,column:50}},"39":{start:{line:139,column:6},end:{line:144,column:7}},"40":{start:{line:140,column:8},end:{line:143,column:11}},"41":{start:{line:146,column:6},end:{line:148,column:9}},"42":{start:{line:151,column:2},end:{line:151,column:19}},"43":{start:{line:154,column:15},end:{line:154,column:24}},"44":{start:{line:155,column:0},end:{line:155,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:24,column:0},end:{line:24,column:1}},loc:{start:{line:24,column:12},end:{line:152,column:1}},line:24},"1":{name:"UsersCtrl",decl:{start:{line:25,column:11},end:{line:25,column:20}},loc:{start:{line:25,column:23},end:{line:27,column:3}},line:25},"2":{name:"getAllUser",decl:{start:{line:38,column:20},end:{line:38,column:30}},loc:{start:{line:38,column:41},end:{line:42,column:5}},line:38},"3":{name:"createUser",decl:{start:{line:52,column:20},end:{line:52,column:30}},loc:{start:{line:52,column:41},end:{line:87,column:5}},line:52},"4":{name:"userLogin",decl:{start:{line:97,column:20},end:{line:97,column:29}},loc:{start:{line:97,column:40},end:{line:122,column:5}},line:97},"5":{name:"(anonymous_5)",decl:{start:{line:102,column:43},end:{line:102,column:44}},loc:{start:{line:102,column:59},end:{line:104,column:7}},line:102},"6":{name:"resetPassword",decl:{start:{line:132,column:20},end:{line:132,column:33}},loc:{start:{line:132,column:44},end:{line:149,column:5}},line:132},"7":{name:"(anonymous_7)",decl:{start:{line:135,column:42},end:{line:135,column:43}},loc:{start:{line:135,column:58},end:{line:137,column:7}},line:135}},branchMap:{"0":{loc:{start:{line:103,column:15},end:{line:103,column:69}},type:"binary-expr",locations:[{start:{line:103,column:15},end:{line:103,column:39}},{start:{line:103,column:43},end:{line:103,column:69}}],line:103},"1":{loc:{start:{line:106,column:6},end:{line:117,column:7}},type:"if",locations:[{start:{line:106,column:6},end:{line:117,column:7}},{start:{line:106,column:6},end:{line:117,column:7}}],line:106},"2":{loc:{start:{line:139,column:6},end:{line:144,column:7}},type:"if",locations:[{start:{line:139,column:6},end:{line:144,column:7}},{start:{line:139,column:6},end:{line:144,column:7}}],line:139}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var _interopRequireDefault=(cov_10540wvn02.s[0]++,require("@babel/runtime/helpers/interopRequireDefault"));cov_10540wvn02.s[1]++;Object.defineProperty(exports,"__esModule",{value:true});cov_10540wvn02.s[2]++;exports.default=void 0;var _classCallCheck2=(cov_10540wvn02.s[3]++,_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")));var _createClass2=(cov_10540wvn02.s[4]++,_interopRequireDefault(require("@babel/runtime/helpers/createClass")));var _jsonwebtoken=(cov_10540wvn02.s[5]++,_interopRequireDefault(require("jsonwebtoken")));var _users=(cov_10540wvn02.s[6]++,_interopRequireDefault(require("../data/users")));/**
 * @class UsersCtrl
 * @classdesc manages Users
 */var UsersCtrl=(/*#__PURE__*/cov_10540wvn02.s[7]++,function(){cov_10540wvn02.f[0]++;function UsersCtrl(){cov_10540wvn02.f[1]++;cov_10540wvn02.s[8]++;(0,_classCallCheck2.default)(this,UsersCtrl);}cov_10540wvn02.s[9]++;(0,_createClass2.default)(UsersCtrl,null,[{key:"getAllUser",/**
     * @description - retrieves all users
     * @param {*} req - Request object
     * @param {*} res - response object
     * @returns {users} returns Users
     */value:function getAllUser(req,res){cov_10540wvn02.f[2]++;cov_10540wvn02.s[10]++;return res.status(200).json({UsersData:_users.default});}/**
     * @description Create a new user either as an Admin or a sale attendant
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {null} - no returns
     */},{key:"createUser",value:function createUser(req,res){cov_10540wvn02.f[3]++;var _req$body=(cov_10540wvn02.s[11]++,req.body),title=(cov_10540wvn02.s[12]++,_req$body.title),firstname=(cov_10540wvn02.s[13]++,_req$body.firstname),lastname=(cov_10540wvn02.s[14]++,_req$body.lastname),emailAddress=(cov_10540wvn02.s[15]++,_req$body.emailAddress),phoneNumber=(cov_10540wvn02.s[16]++,_req$body.phoneNumber),role=(cov_10540wvn02.s[17]++,_req$body.role),gender=(cov_10540wvn02.s[18]++,_req$body.gender),passport=(cov_10540wvn02.s[19]++,_req$body.passport),contactAddress=(cov_10540wvn02.s[20]++,_req$body.contactAddress);var id=(cov_10540wvn02.s[21]++,_users.default.length+1);var staffId=(cov_10540wvn02.s[22]++,"SM0".concat(id));var createdAt=(cov_10540wvn02.s[23]++,new Date());var newUser=(cov_10540wvn02.s[24]++,{id:id,title:title,staffId:staffId,firstname:firstname,lastname:lastname,emailAddress:emailAddress,phoneNumber:phoneNumber,role:role,gender:gender,passport:passport,contactAddress:contactAddress,createdAt:createdAt});cov_10540wvn02.s[25]++;_users.default.push(newUser);cov_10540wvn02.s[26]++;res.status(201).json({msg:'New user successfully created',data:newUser});}/**
     * @description - Accept two field to login a user
     * @param {*} req - request object
     * @param {*} res - response object
     * @returns {null} - no return
     */},{key:"userLogin",value:function userLogin(req,res){cov_10540wvn02.f[4]++;var _req$body2=(cov_10540wvn02.s[27]++,req.body),staffId=(cov_10540wvn02.s[28]++,_req$body2.staffId),password=(cov_10540wvn02.s[29]++,_req$body2.password);var userDetail=(cov_10540wvn02.s[30]++,_users.default.find(function(user){cov_10540wvn02.f[5]++;cov_10540wvn02.s[31]++;return(cov_10540wvn02.b[0][0]++,user.staffId===staffId)&&(cov_10540wvn02.b[0][1]++,user.password===password);}));cov_10540wvn02.s[32]++;if(userDetail){cov_10540wvn02.b[1][0]++;var token=(cov_10540wvn02.s[33]++,_jsonwebtoken.default.sign({staffId:"".concat(userDetail.role)},process.env.SECRET,{expiresIn:'1h'}));cov_10540wvn02.s[34]++;return res.status(200).json({msg:'Login successful',token:token});}else{cov_10540wvn02.b[1][1]++;}cov_10540wvn02.s[35]++;res.status(404).json({msg:'Login failed'});}/**
     * @description - Reset user password
     * @param {*} req - request object
     * @param {*} res  - response object
     * @returns {null} - No returns
     */},{key:"resetPassword",value:function resetPassword(req,res){cov_10540wvn02.f[6]++;var emailAddress=(cov_10540wvn02.s[36]++,req.body.emailAddress);var userIndex=(cov_10540wvn02.s[37]++,_users.default.find(function(user){cov_10540wvn02.f[7]++;cov_10540wvn02.s[38]++;return user.emailAddress===emailAddress;}));cov_10540wvn02.s[39]++;if(userIndex){cov_10540wvn02.b[2][0]++;cov_10540wvn02.s[40]++;return res.status(200).json({msg:"A mail has been forwarded to ".concat(emailAddress,". Follow the link to reset your password"),emailAddress:emailAddress});}else{cov_10540wvn02.b[2][1]++;}cov_10540wvn02.s[41]++;res.status(404).json({msg:"Your email address: ".concat(emailAddress," is not recognised.")});}}]);cov_10540wvn02.s[42]++;return UsersCtrl;}());var _default=(cov_10540wvn02.s[43]++,UsersCtrl);cov_10540wvn02.s[44]++;exports.default=_default;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsiVXNlcnNDdHJsIiwicmVxIiwicmVzIiwic3RhdHVzIiwianNvbiIsIlVzZXJzRGF0YSIsImJvZHkiLCJ0aXRsZSIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwiZW1haWxBZGRyZXNzIiwicGhvbmVOdW1iZXIiLCJyb2xlIiwiZ2VuZGVyIiwicGFzc3BvcnQiLCJjb250YWN0QWRkcmVzcyIsImlkIiwibGVuZ3RoIiwic3RhZmZJZCIsImNyZWF0ZWRBdCIsIkRhdGUiLCJuZXdVc2VyIiwicHVzaCIsIm1zZyIsImRhdGEiLCJwYXNzd29yZCIsInVzZXJEZXRhaWwiLCJmaW5kIiwidXNlciIsInRva2VuIiwiand0Iiwic2lnbiIsInByb2Nlc3MiLCJlbnYiLCJTRUNSRVQiLCJleHBpcmVzSW4iLCJ1c2VySW5kZXgiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFFQTs7OztJQUlNQSxTOzs7Ozs7Ozs7O0FBQ0o7Ozs7OzsrQkFNa0JDLEcsRUFBS0MsRyxFQUFLO0FBQzFCLGFBQU9BLEdBQUcsQ0FBQ0MsTUFBSixDQUFXLEdBQVgsRUFBZ0JDLElBQWhCLENBQXFCO0FBQUVDLFFBQUFBLFNBQVMsRUFBVEE7QUFBRixPQUFyQixDQUFQO0FBQ0Q7QUFFRDs7Ozs7Ozs7OytCQU1rQkosRyxFQUFLQyxHLEVBQUs7QUFBQSxzQkFXdEJELEdBQUcsQ0FBQ0ssSUFYa0I7QUFBQSxVQUV4QkMsS0FGd0IsYUFFeEJBLEtBRndCO0FBQUEsVUFHeEJDLFNBSHdCLGFBR3hCQSxTQUh3QjtBQUFBLFVBSXhCQyxRQUp3QixhQUl4QkEsUUFKd0I7QUFBQSxVQUt4QkMsWUFMd0IsYUFLeEJBLFlBTHdCO0FBQUEsVUFNeEJDLFdBTndCLGFBTXhCQSxXQU53QjtBQUFBLFVBT3hCQyxJQVB3QixhQU94QkEsSUFQd0I7QUFBQSxVQVF4QkMsTUFSd0IsYUFReEJBLE1BUndCO0FBQUEsVUFTeEJDLFFBVHdCLGFBU3hCQSxRQVR3QjtB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QUFBQSxHQUFHLGdDQUF5QmIsWUFBekI7QUFEZ0IsT0FBckI7QUFHRDs7Ozs7ZUFHWVYsUyIsInNvdXJjZVJvb3QiOiIvVXNlcnMvYW5kZWxhL0Rlc2t0b3Avc20vc3RvcmUtbWFuYWdlci9hcHAvY29udHJvbGxlciIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJztcblxuaW1wb3J0IFVzZXJzRGF0YSBmcm9tICcuLi9kYXRhL3VzZXJzJztcblxuLyoqXG4gKiBAY2xhc3MgVXNlcnNDdHJsXG4gKiBAY2xhc3NkZXNjIG1hbmFnZXMgVXNlcnNcbiAqL1xuY2xhc3MgVXNlcnNDdHJsIHtcbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiAtIHJldHJpZXZlcyBhbGwgdXNlcnNcbiAgICogQHBhcmFtIHsqfSByZXEgLSBSZXF1ZXN0IG9iamVjdFxuICAgKiBAcGFyYW0geyp9IHJlcyAtIHJlc3BvbnNlIG9iamVjdFxuICAgKiBAcmV0dXJucyB7dXNlcnN9IHJldHVybnMgVXNlcnNcbiAgICovXG4gIHN0YXRpYyBnZXRBbGxVc2VyKHJlcSwgcmVzKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgVXNlcnNEYXRhIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiBDcmVhdGUgYSBuZXcgdXNlciBlaXRoZXIgYXMgYW4gQWRtaW4gb3IgYSBzYWxlIGF0dGVuZGFudFxuICAgKiBAcGFyYW0geyp9IHJlcSAtIHJlcXVlc3Qgb2JqZWN0XG4gICAqIEBwYXJhbSB7Kn0gcmVzIC0gcmVzcG9uc2Ugb2JqZWN0XG4gICAqIEByZXR1cm5zIHtudWxsfSAtIG5vIHJldHVybnNcbiAgICovXG4gIHN0YXRpYyBjcmVhdGVVc2VyKHJlcSwgcmVzKSB7XG4gICAgY29uc3Qge1xuICAgICAgdGl0bGUsXG4gICAgICBmaXJzdG5hbWUsXG4gICAgICBsYXN0bmFtZSxcbiAgICAgIGVtYWlsQWRkcmVzcyxcbiAgICAgIHBob25lTnVtYmVyLFxuICAgICAgcm9sZSxcbiAgICAgIGdlbmRlcixcbiAgICAgIHBhc3Nwb3J0LFxuICAgICAgY29udGFjdEFkZHJlc3NcbiAgICB9ID0gcmVxLmJvZHk7XG4gICAgY29uc3QgaWQgPSBVc2Vyc0RhdGEubGVuZ3RoICsgMTtcbiAgICBjb25zdCBzdGFmZklkID0gYFNNMCR7aWR9YDtcbiAgICBjb25zdCBjcmVhdGVkQXQgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IG5ld1VzZXIgPSB7XG4gICAgICBpZCxcbiAgICAgIHRpdGxlLFxuICAgICAgc3RhZmZJZCxcbiAgICAgIGZpcnN0bmFtZSxcbiAgICAgIGxhc3RuYW1lLFxuICAgICAgZW1haWxBZGRyZXNzLFxuICAgICAgcGhvbmVOdW1iZXIsXG4gICAgICByb2xlLFxuICAgICAgZ2VuZGVyLFxuICAgICAgcGFzc3BvcnQsXG4gICAgICBjb250YWN0QWRkcmVzcyxcbiAgICAgIGNyZWF0ZWRBdFxuICAgIH07XG4gICAgVXNlcnNEYXRhLnB1c2gobmV3VXNlcik7XG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24oe1xuICAgICAgbXNnOiAnTmV3IHVzZXIgc3VjY2Vzc2Z1bGx5IGNyZWF0ZWQnLFxuICAgICAgZGF0YTogbmV3VXNlclxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBkZXNjcmlwdGlvbiAtIEFjY2VwdCB0d28gZmllbGQgdG8gbG9naW4gYSB1c2VyXG4gICAqIEBwYXJhbSB7Kn0gcmVxIC0gcmVxdWVzdCBvYmplY3RcbiAgICogQHBhcmFtIHsqfSByZXMgLSByZXNwb25zZSBvYmplY3RcbiAgICogQHJldHVybnMge251bGx9IC0gbm8gcmV0dXJuXG4gICAqL1xuICBzdGF0aWMgdXNlckxvZ2luKHJlcSwgcmVzKSB7XG4gICAgY29uc3QgeyBzdGFmZklkLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgY29uc3QgdXNlckRldGFpbCA9IFVzZXJzRGF0YS5maW5kKHVzZXIgPT4gdXNlci5zdGFmZklkID09PSBzdGFmZklkICYmIHVzZXIucGFzc3dvcmQgPT09IHBhc3N3b3JkKTtcbiAgICBpZiAodXNlckRldGFpbCkge1xuICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IHN0YWZmSWQ6IGAke3VzZXJEZXRhaWwucm9sZX1gIH0sIHByb2Nlc3MuZW52LlNFQ1JFVCwgeyBleHBpcmVzSW46ICcxaCcgfSk7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBtc2c6ICdMb2dpbiBzdWNjZXNzZnVsJyxcbiAgICAgICAgdG9rZW5cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICBtc2c6ICdMb2dpbiBmYWlsZWQnXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uIC0gUmVzZXQgdXNlciBwYXNzd29yZFxuICAgKiBAcGFyYW0geyp9IHJlcSAtIHJlcXVlc3Qgb2JqZWN0XG4gICAqIEBwYXJhbSB7Kn0gcmVzICAtIHJlc3BvbnNlIG9iamVjdFxuICAgKiBAcmV0dXJucyB7bnVsbH0gLSBObyByZXR1cm5zXG4gICAqL1xuICBzdGF0aWMgcmVzZXRQYXNzd29yZChyZXEsIHJlcykge1xuICAgIGNvbnN0IHsgZW1haWxBZGRyZXNzIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VySW5kZXggPSBVc2Vyc0RhdGEuZmluZCh1c2VyID0+IHVzZXIuZW1haWxBZGRyZXNzID09PSBlbWFpbEFkZHJlc3MpO1xuICAgIGlmICh1c2VySW5kZXgpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIG1zZzogYEEgbWFpbCBoYXMgYmVlbiBmb3J3YXJkZWQgdG8gJHtlbWFpbEFkZHJlc3N9LiBGb2xsb3cgdGhlIGxpbmsgdG8gcmVzZXQgeW91ciBwYXNzd29yZGAsXG4gICAgICAgIGVtYWlsQWRkcmVzc1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICAgIG1zZzogYFlvdXIgZW1haWwgYWRkcmVzczogJHtlbWFpbEFkZHJlc3N9IGlzIG5vdCByZWNvZ25pc2VkLmBcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBVc2Vyc0N0cmw7XG4iXX0=